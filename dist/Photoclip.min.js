/*!
 * PhotoClip - 一款手势驱动的裁图插件
 * @version v3.3.7
 * @author baijunjie
 * @license MIT
 * 
 * git - https://github.com/baijunjie/PhotoClip.git
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("lrz"),require("iscroll/build/iscroll-zoom"),require("hammerjs")):"function"==typeof define&&define.amd?define(["lrz","iscroll","hammerjs"],e):"object"==typeof exports?exports.PhotoClip=e(require("lrz"),require("iscroll/build/iscroll-zoom"),require("hammerjs")):t.PhotoClip=e(t.lrz,t.IScroll,t.Hammer)}(window,function(t,e,i){return function(t){var e={};function i(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(o,r,function(e){return t[e]}.bind(null,r));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=4)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(t){return t/180*Math.PI}e.getScale=function(t,e,i,o){var r=t/i,n=e/o;return r>n?r:n},e.pointRotate=function(t,e){var i=r(e),o=Math.sin(i),n=Math.cos(i);return{x:n*t.x-o*t.y,y:n*t.y+o*t.x}},e.angleToRadian=r,e.loaclToLoacl=function(t,e,i,o){i=i||0,o=o||0;var r=void 0,n=void 0;return s([t,e],function(){r=t.getBoundingClientRect(),n=e.getBoundingClientRect()}),{x:n.left-r.left+i,y:n.top-r.top+o}},e.globalToLoacl=function(t,e,i){e=e||0,i=i||0;var o=void 0;return s(t,function(){o=t.getBoundingClientRect()}),{x:e-o.left,y:i-o.top}},e.extend=function t(){var e=void 0,i=void 0,r=void 0,n=void 0,a=void 0,s=arguments[0]||{},l=void 0===s?"undefined":o(s),c=Object.prototype.toString,u=1,h=arguments.length,_=!1;"boolean"===l&&(_=s,s=arguments[u]||{},l=void 0===s?"undefined":o(s),u++);"object"!==l&&"function"!==l&&(s={});u===h&&(s=this,u--);for(;u<h;u++)if(null!=(e=arguments[u]))for(i in e)r=s[i],n=e[i],s!==n&&(_&&n&&((a="[object Array]"===c.call(n))||"[object Object]"===c.call(n))?(a?(a=!1,r=r&&"[object Array]"===c.call(r)?r:[]):r=r&&"[object Object]"===c.call(r)?r:{},s[i]=t(_,r,n)):void 0!==n&&(s[i]=n));return s},e.proxy=function(t,e){if("string"==typeof e){var i=t[e];e=t,t=i}if("function"!=typeof t)return;var o=Array.prototype.slice,r=o.call(arguments,2),a=function(){return t.apply(e||this,r.concat(o.call(arguments)))};return a.guid=t.guid=t.guid||n++,a},e.hideAction=s,e.isPercent=function(t){return/%$/.test(t+"")},e.isNumber=l,e.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},e.toArray=c,e.createElement=function(t,e,i,r){var n=document.createElement("DIV");"object"===(void 0===e?"undefined":o(e))&&(r=e,e=null);"object"===(void 0===i?"undefined":o(i))&&(r=i,i=null);if("object"===(void 0===r?"undefined":o(r)))for(var a in r)n.style[a]=r[a];e&&(n.className=e);i&&(n.id=i);return t.appendChild(n),n},e.removeElement=function(t){t.parentNode&&t.parentNode.removeChild(t)},e.$=function(t,e){if(t instanceof HTMLElement)return[t];if("object"===(void 0===t?"undefined":o(t))&&t.length)return c(t);if(!t||"string"!=typeof t)return[];"string"==typeof e&&(e=document.querySelector(e));e instanceof HTMLElement||(e=document);return c(e.querySelectorAll(t))},e.attr=function(t,e,i){if("object"===(void 0===e?"undefined":o(e))){for(var r in e)t[r]=e[r];return t}return void 0===i?t[e]:(t[e]=i,t)},e.css=function(t,e,i){if("object"===(void 0===e?"undefined":o(e))){for(var r in e)l(i=e[r])&&(i+="px"),t.style[r]=i;return t}return void 0===i?window.getComputedStyle(t)[e]:(l(i)&&(i+="px"),t.style[e]=i,t)},e.support=function(t){var e=document.documentElement;if(t in e.style)return"";for(var i,o=t.charAt(0).toUpperCase()+t.substr(1),r=["Webkit","Moz","ms","O"],n=0;i=r[n++];)if(i+o in e.style)return"-"+i.toLowerCase()+"-"};var n=0;var a={};function s(t,e,i){"object"!==(void 0===t?"undefined":o(t))&&(t=[]),void 0===t.length&&(t=[t]);for(var r,n=[],s=[],l=0;r=t[l++];)for(;r instanceof HTMLElement;){var c=r.nodeName;if(!r.getClientRects().length){n.push(r),s.push(r.style.display);var u=a[c];if(!u){var h=document.createElement(c);document.body.appendChild(h),u=window.getComputedStyle(h).display,h.parentNode.removeChild(h),"none"===u&&(u="block"),a[c]=u}r.style.display=u}if("BODY"===c)break;r=r.parentNode}"function"==typeof e&&e.call(i||this);for(var _=n.length;_--;)n.pop().style.display=s.pop()}function l(t){return"number"==typeof t}function c(t){return Array.prototype.map.call(t,function(t){return t})}},function(e,i){e.exports=t},function(t,i){t.exports=e},function(t,e){t.exports=i},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),n=c(i(3)),a=c(i(2)),s=c(i(1)),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(0));function c(t){return t&&t.__esModule?t:{default:t}}var u=!!navigator.userAgent.match(/mobile/i),h=!!navigator.userAgent.match(/android/i),_=l.support("transition"),p=l.support("transform"),d=function(){},f={size:[100,100],adaptive:"",outputSize:[0,0],outputType:"jpg",outputQuality:.8,maxZoom:1,rotateFree:!h,view:"",file:"",ok:"",img:"",loadStart:d,loadComplete:d,loadError:d,done:d,fail:d,lrzOption:{width:h?1e3:void 0,height:h?1e3:void 0,quality:.7},style:{maskColor:"rgba(0,0,0,.5)",maskBorder:"2px dashed #ddd",jpgFillColor:"#fff"},errorMsg:{noSupport:"您的浏览器版本过于陈旧，无法支持裁图功能，请更换新的浏览器！",imgError:"不支持该图片格式，请选择常规格式的图片文件！",imgHandleError:"图片处理失败！请更换其它图片尝试。",imgLoadError:"图片读取失败！请更换其它图片尝试。",noImg:"没有可裁剪的图片！",clipError:"截图失败！当前图片源文件可能存在跨域问题，请确保图片与应用同源。如果您是在本地环境下执行本程序，请更换至服务器环境。"}},m=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),y.call(this),(e=l.$(e))&&e.length&&(this._$container=e[0],this._options=l.extend(!0,{},f,i),void 0===p&&this._options.errorMsg.noSupport&&alert(this._options.errorMsg.noSupport),this._init())}return r(t,[{key:"_init",value:function(){var t=this,e=this._options;l.isNumber(e.size)?e.size=[e.size,e.size]:l.isArray(e.size)?((!l.isNumber(e.size[0])||e.size[0]<=0)&&(e.size[0]=f.size[0]),(!l.isNumber(e.size[1])||e.size[1]<=0)&&(e.size[1]=f.size[1])):e.size=l.extend({},f.size),l.isNumber(e.outputSize)?e.outputSize=[e.outputSize,0]:l.isArray(e.outputSize)?((!l.isNumber(e.outputSize[0])||e.outputSize[0]<0)&&(e.outputSize[0]=f.outputSize[0]),(!l.isNumber(e.outputSize[1])||e.outputSize[1]<0)&&(e.outputSize[1]=f.outputSize[1])):e.outputSize=l.extend({},f.outputSize),"jpg"===e.outputType?e.outputType="image/jpeg":e.outputType="image/png",l.isArray(e.adaptive)&&(this._widthIsPercent=!(!e.adaptive[0]||!l.isPercent(e.adaptive[0]))&&e.adaptive[0],this._heightIsPercent=!(!e.adaptive[1]||!l.isPercent(e.adaptive[1]))&&e.adaptive[1]),this._outputWidth=e.outputSize[0],this._outputHeight=e.outputSize[1],this._canvas=document.createElement("canvas"),this._iScroll=null,this._hammerManager=null,this._clipWidth=0,this._clipHeight=0,this._clipSizeRatio=1,this._$img=null,this._imgLoaded=!1,this._containerWidth=0,this._containerHeight=0,this._$clipLayer=null,this._$moveLayer=null,this._$rotationLayer=null,this._viewList=null,this._fileList=null,this._okList=null,this._$mask=null,this._$mask_left=null,this._$mask_right=null,this._$mask_right=null,this._$mask_bottom=null,this._$clip_frame=null,this._atRotation=!1,this._rotationLayerWidth=0,this._rotationLayerHeight=0,this._rotationLayerX=0,this._rotationLayerY=0,this._rotationLayerOriginX=0,this._rotationLayerOriginY=0,this._curAngle=0,this._initElements(),this._initScroll(),this._initRotationEvent(),this._initFile(),this._resize(),window.addEventListener("resize",this._resize),(this._okList=l.$(e.ok))&&this._okList.forEach(function(e){e.addEventListener("click",t._clipImg)}),this._options.img&&this._lrzHandle(this._options.img)}},{key:"_initElements",value:function(){var t=this._$container,e=t.style,i={};i["user-select"]=e["user-select"],i.overflow=e.overflow,i.position=e.position,this._containerOriginStyle=i,l.css(t,{"user-select":"none",overflow:"hidden"}),"static"===l.css(t,"position")&&l.css(t,"position","relative"),this._$clipLayer=l.createElement(t,"photo-clip-layer",{position:"absolute",left:"50%",top:"50%"}),this._$moveLayer=l.createElement(this._$clipLayer,"photo-clip-move-layer"),this._$rotationLayer=l.createElement(this._$moveLayer,"photo-clip-rotation-layer");var o=this._$mask=l.createElement(t,"photo-clip-mask",{position:"absolute",left:0,top:0,width:"100%",height:"100%","pointer-events":"none"}),r=this._options,n=r.style.maskColor,a=r.style.maskBorder;if(this._$mask_left=l.createElement(o,"photo-clip-mask-left",{position:"absolute",left:0,right:"50%",top:"50%",bottom:"50%",width:"auto","background-color":n}),this._$mask_right=l.createElement(o,"photo-clip-mask-right",{position:"absolute",left:"50%",right:0,top:"50%",bottom:"50%","background-color":n}),this._$mask_top=l.createElement(o,"photo-clip-mask-top",{position:"absolute",left:0,right:0,top:0,bottom:"50%","background-color":n}),this._$mask_bottom=l.createElement(o,"photo-clip-mask-bottom",{position:"absolute",left:0,right:0,top:"50%",bottom:0,"background-color":n}),this._$clip_frame=l.createElement(o,"photo-clip-area",{border:a,position:"absolute",left:"50%",top:"50%"}),this._viewList=l.$(r.view),this._viewList){var s=[];this._viewList.forEach(function(t,e){var i=t.style,o={};o["background-repeat"]=i["background-repeat"],o["background-position"]=i["background-position"],o["background-size"]=i["background-size"],s[e]=o,l.css(t,{"background-repeat":"no-repeat","background-position":"center","background-size":"contain"})}),this._viewOriginStyleList=s}}},{key:"_initScroll",value:function(){this._iScroll=new a.default(this._$clipLayer,{zoom:!0,scrollX:!0,scrollY:!0,freeScroll:!0,mouseWheel:!0,disablePointer:!0,disableTouch:!1,disableMouse:!1,wheelAction:"zoom",bounceTime:300})}},{key:"_refreshScroll",value:function(t){t=t||0;var e=this._iScroll.options,i=this._options.maxZoom,o=this._rotationLayerWidth,r=this._rotationLayerHeight;o&&r?(e.zoomMin=l.getScale(this._clipWidth,this._clipHeight,o,r),e.zoomMax=Math.max(i,e.zoomMin),e.startZoom=Math.min(e.zoomMax,l.getScale(this._containerWidth,this._containerHeight,o,r))):(e.zoomMin=1,e.zoomMax=i,e.startZoom=1),l.css(this._$moveLayer,{width:o,height:r}),this._$clipLayer.appendChild(this._$moveLayer),this._iScroll.refresh(t)}},{key:"_resetScroll",value:function(t,e){t=t||0,e=e||0,this._rotationLayerWidth=t,this._rotationLayerHeight=e,this._rotationLayerX=0,this._rotationLayerY=0,this._curAngle=0,v(this._$rotationLayer,this._rotationLayerX,this._rotationLayerY,this._curAngle),l.css(this._$rotationLayer,{width:t,height:e}),this._refreshScroll();var i=this._iScroll,o=i.scale,r=.5*(this._clipWidth-t*o),n=.5*(this._clipHeight-e*o);i.scrollTo(r,n),i.zoom(i.options.startZoom,void 0,void 0,0)}},{key:"_initRotationEvent",value:function(){var t=this;if(u){this._hammerManager=new n.default.Manager(this._$moveLayer),this._hammerManager.add(new n.default.Rotate);var e=this._options.rotateFree,i=this._iScroll.options.bounceTime,o=void 0,r=void 0,a=void 0;this._hammerManager.on("rotatestart",function(i){t._atRotation||(o=!0,e?(r=(i.rotation-t._curAngle)%360,t._rotationLayerRotateReady(i.center)):r=i.rotation)}),this._hammerManager.on("rotatemove",function(i){o&&(a=i.rotation-r,e&&t._rotationLayerRotate(a))}),this._hammerManager.on("rotateend rotatecancel",function(r){if(o){if(o=!1,!e)return(a%=360)>180?a-=360:a<-180&&(a+=360),void(a>30?t._rotateBy(90,i,r.center):a<-30&&t._rotateBy(-90,i,r.center));var n=a%360;n<0&&(n+=360),n<10?a+=-n:n>80&&n<100?a+=90-n:n>170&&n<190?a+=180-n:n>260&&n<280?a+=270-n:n>350&&(a+=360-n),t._rotationLayerRotateFinish(a,i)}})}else this._$moveLayer.addEventListener("dblclick",this._rotateCW90)}},{key:"_rotateBy",value:function(t,e,i){this._rotateTo(this._curAngle+t,e,i)}},{key:"_rotateTo",value:function(t,e,i){this._atRotation||(this._rotationLayerRotateReady(i),this._rotationLayerRotateFinish(t,e))}},{key:"_rotationLayerRotateReady",value:function(t){var e=this._iScroll.scale,i=void 0;(i=t?l.globalToLoacl(this._$rotationLayer,t.x,t.y):l.loaclToLoacl(this._$rotationLayer,this._$clipLayer,.5*this._clipWidth,.5*this._clipHeight)).x/=e,i.y/=e;var o={x:i.x-this._rotationLayerX,y:i.y-this._rotationLayerY},r=l.pointRotate(o,-this._curAngle);this._rotationLayerOriginX=r.x,this._rotationLayerOriginY=r.y;var n=this._$rotationLayer.getBoundingClientRect();g(this._$rotationLayer,this._rotationLayerOriginX,this._rotationLayerOriginY);var a=this._$rotationLayer.getBoundingClientRect();this._rotationLayerX+=(n.left-a.left)/e,this._rotationLayerY+=(n.top-a.top)/e,v(this._$rotationLayer,this._rotationLayerX,this._rotationLayerY,this._curAngle)}},{key:"_rotationLayerRotate",value:function(t){v(this._$rotationLayer,this._rotationLayerX,this._rotationLayerY,t),this._curAngle=t}},{key:"_rotationLayerRotateFinish",value:function(t,e){var i=this;v(this._$rotationLayer,this._rotationLayerX,this._rotationLayerY,t);var o=this._$rotationLayer.getBoundingClientRect();g(this._$rotationLayer,0,0);var r=this._$rotationLayer.getBoundingClientRect();v(this._$rotationLayer,this._rotationLayerX,this._rotationLayerY,0);var n=this._$rotationLayer.getBoundingClientRect(),a=this._$moveLayer.getBoundingClientRect(),s=this._iScroll,c=s.scale,u={x:o.left-a.left,y:o.top-a.top};this._rotationLayerWidth=o.width/c,this._rotationLayerHeight=o.height/c,this._rotationLayerX=(n.left-r.left)/c,this._rotationLayerY=(n.top-r.top)/c,s.scrollTo(s.x+u.x,s.y+u.y),this._refreshScroll(s.options.bounceTime);var h=Math.max(s.options.zoomMin,Math.min(s.options.zoomMax,c));h!==c&&(u.x=u.x/c*h,u.y=u.y/c*h),s.startX+=u.x,s.startY+=u.y,t!==this._curAngle&&e&&l.isNumber(e)&&void 0!==_?(u={x:(r.left-o.left)/c,y:(r.top-o.top)/c},g(this._$rotationLayer,this._rotationLayerOriginX,this._rotationLayerOriginY),v(this._$rotationLayer,this._rotationLayerX+u.x,this._rotationLayerY+u.y,this._curAngle),this._atRotation=!0,function(t,e,i,o,r,n){l.css(t,p+"transform"),l.css(t,p+"transition",p+"transform "+r+"ms cubic-bezier(0.1, 0.57, 0.1, 1)"),v(t,e,i,o),setTimeout(function(){l.css(t,p+"transition",""),n()},r)}(this._$rotationLayer,this._rotationLayerX+u.x,this._rotationLayerY+u.y,t,e,function(){i._atRotation=!1,i._rotateFinishUpdataElem(t)})):this._rotateFinishUpdataElem(t)}},{key:"_rotateFinishUpdataElem",value:function(t){g(this._$rotationLayer,this._rotationLayerOriginX=0,this._rotationLayerOriginY=0),v(this._$rotationLayer,this._rotationLayerX,this._rotationLayerY,this._curAngle=t%360)}},{key:"_initFile",value:function(){var t=this,e=this._options;(this._fileList=l.$(e.file))&&this._fileList.forEach(function(e){u||l.attr(e,"accept","image/jpeg, image/x-png, image/png, image/gif"),e.addEventListener("change",t._fileOnChangeHandle)})}},{key:"_lrzHandle",value:function(t){var e=this,i=this._options,r=i.errorMsg;if("object"===(void 0===t?"undefined":o(t))&&t.type&&!/image\/\w+/.test(t.type))return i.loadError.call(this,r.imgError),!1;this._imgLoaded=!1,i.loadStart.call(this,t);try{(0,s.default)(t,i.lrzOption).then(function(t){e._clearImg(),e._createImg(t.base64)}).catch(function(t){i.loadError.call(e,r.imgHandleError,t)})}catch(t){throw i.loadError.call(this,r.imgHandleError,t),t}}},{key:"_clearImg",value:function(){this._$img&&(this._$img.onload=null,this._$img.onerror=null,l.removeElement(this._$img),this._$img=null,this._imgLoaded=!1)}},{key:"_createImg",value:function(t){var e=this,i=this._options,o=i.errorMsg;this._$img=new Image,l.css(this._$img,{"user-select":"none","pointer-events":"none"}),this._$img.onload=function(t){var o=t.target;e._imgLoaded=!0,i.loadComplete.call(e,o),e._$rotationLayer.appendChild(o),l.hideAction([o,e._$moveLayer],function(){e._resetScroll(o.naturalWidth,o.naturalHeight)})},this._$img.onerror=function(t){i.loadError.call(e,o.imgLoadError,t)},l.attr(this._$img,"src",t)}}]),t}(),y=function(){var t=this;this._rotateCW90=function(e){t._rotateBy(90,t._iScroll.options.bounceTime,{x:e.clientX,y:e.clientY})},this._fileOnChangeHandle=function(e){var i=e.target.files;i.length&&t._lrzHandle(i[0])},this._clipImg=function(){var e=t._options,i=e.errorMsg;if(t._imgLoaded){var o=l.loaclToLoacl(t._$rotationLayer,t._$clipLayer),r=t._iScroll.scale,n=t._canvas.getContext("2d"),a=1,s=1;t._outputWidth||t._outputHeight?(t._canvas.width=t._outputWidth,t._canvas.height=t._outputHeight,a=t._outputWidth/t._clipWidth*r,s=t._outputHeight/t._clipHeight*r):(t._canvas.width=t._clipWidth/r,t._canvas.height=t._clipHeight/r),n.clearRect(0,0,t._canvas.width,t._canvas.height),n.fillStyle=e.style.jpgFillColor,n.fillRect(0,0,t._canvas.width,t._canvas.height),n.save(),n.scale(a,s),n.translate(t._rotationLayerX-o.x/r,t._rotationLayerY-o.y/r),n.rotate(t._curAngle*Math.PI/180),n.drawImage(t._$img,0,0),n.restore();try{var c=t._canvas.toDataURL(e.outputType,e.outputQuality);return t._viewList&&t._viewList.forEach(function(t){l.css(t,"background-image","url("+c+")")}),e.done.call(t,c),c}catch(o){throw e.fail.call(t,i.clipError),o}}else e.fail.call(t,i.noImg)},this._resize=function(e,i){l.hideAction(t._$container,function(){this._containerWidth=this._$container.offsetWidth,this._containerHeight=this._$container.offsetHeight},t);var o=t._options.size,r=t._clipWidth,n=t._clipHeight;if(l.isNumber(e)&&(o[0]=e),l.isNumber(i)&&(o[1]=i),t._widthIsPercent||t._heightIsPercent){var a=o[0]/o[1];t._widthIsPercent&&(t._clipWidth=t._containerWidth/100*parseFloat(t._widthIsPercent),t._heightIsPercent||(t._clipHeight=t._clipWidth/a)),t._heightIsPercent&&(t._clipHeight=t._containerHeight/100*parseFloat(t._heightIsPercent),t._widthIsPercent||(t._clipWidth=t._clipHeight*a))}else t._clipWidth=o[0],t._clipHeight=o[1];var s=t._clipWidth,c=t._clipHeight;if(t._clipSizeRatio=s/c,t._outputWidth&&!t._outputHeight&&(t._outputHeight=t._outputWidth/t._clipSizeRatio),t._outputHeight&&!t._outputWidth&&(t._outputWidth=t._outputHeight*t._clipSizeRatio),l.css(t._$clipLayer,{width:s,height:c,"margin-left":-s/2,"margin-top":-c/2}),l.css(t._$mask_left,{"margin-right":s/2,"margin-top":-c/2,"margin-bottom":-c/2}),l.css(t._$mask_right,{"margin-left":s/2,"margin-top":-c/2,"margin-bottom":-c/2}),l.css(t._$mask_top,{"margin-bottom":c/2}),l.css(t._$mask_bottom,{"margin-top":c/2}),l.css(t._$clip_frame,{width:s,height:c}),l.css(t._$clip_frame,p+"transform","translate(-50%, -50%)"),s!==r||c!==n){t._refreshScroll();var u=t._iScroll,h=u.scale,_=.5*(s-r)*h,d=.5*(c-n)*h;u.scrollBy(_,d);var f=Math.max(u.options.zoomMin,Math.min(u.options.zoomMax,h));f!==h&&u.zoom(f,void 0,void 0,0)}},this.size=function(e,i){return t._resize(e,i),t},this.load=function(e){return t._lrzHandle(e),t},this.clear=function(){return t._clearImg(),t._resetScroll(),t._fileList&&t._fileList.forEach(function(t){t.value=""}),t},this.rotate=function(e,i){return void 0===e?t._curAngle:(t._rotateTo(e,i),t)},this.scale=function(e,i){return void 0===e?t._iScroll.scale:(t._iScroll.zoom(e,void 0,void 0,i),t)},this.clip=function(){return t._clipImg()},this.destroy=function(){window.removeEventListener("resize",t._resize),t._$container.removeChild(t._$clipLayer),t._$container.removeChild(t._$mask),l.css(t._$container,t._containerOriginStyle),t._iScroll&&t._iScroll.destroy(),t._hammerManager?(t._hammerManager.off("rotatemove"),t._hammerManager.off("rotateend"),t._hammerManager.destroy()):t._$moveLayer.removeEventListener("dblclick",t._rotateCW90),t._$img&&(t._$img.onload=null,t._$img.onerror=null),t._viewList&&t._viewList.forEach(function(e,i){l.css(e,t._viewOriginStyleList[i])}),t._fileList&&t._fileList.forEach(function(e){e.removeEventListener("change",t._fileOnChangeHandle)}),t._okList&&t._okList.forEach(function(e){e.removeEventListener("click",t._clipImg)}),Object.getOwnPropertyNames(t).forEach(function(e){delete t[e]}),t.__proto__=Object.prototype}};function g(t,e,i){e=(e||0).toFixed(2),i=(i||0).toFixed(2),l.css(t,p+"transform-origin",e+"px "+i+"px")}function v(t,e,i,o){e=e.toFixed(2),i=i.toFixed(2),o=o.toFixed(2),l.css(t,p+"transform","translateZ(0) translate("+e+"px,"+i+"px) rotate("+o+"deg)")}e.default=m,t.exports=e.default}])});